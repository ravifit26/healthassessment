<!DOCTYPE html>
<html>
<head>
<title>P3 Health & Lifestyle Assessment</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
    :root {
        --primary: #673ab7;
        --secondary: #00c853; 
        --text: #2c3e50;
        /* Section Colors */
        --profile-bg: #f0f4f8; --profile-text: #455a64;
        --priority-bg: #e0f2f1; --priority-text: #00695c;
        --purpose-bg: #f1f8e9;  --purpose-text: #2e7d32;
        --perf-bg: #e8eaf6;     --perf-text: #283593;
    }

    body{font-family:'Montserrat', sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); margin:0; padding:10px 0; color: var(--text);}
    .form-container{background:#ffffff; max-width:820px; margin:0 auto; border-radius:20px; box-shadow:0 15px 35px rgba(0,0,0,0.1); overflow:hidden;}
    
    .form-header{background: var(--primary); padding:25px 20px; text-align:center; color: #ffffff;}
    .header-title{font-size:30px; font-weight:700; margin:0; letter-spacing: 2px; text-transform: uppercase;}
    .header-subtitle{font-size:18px; font-weight: 500; opacity:0.9; margin-top:5px;}

    .content-padding { padding: 10px 35px 30px; }
    .progress-wrapper { padding: 15px 35px 0; }
    .progress-container { width: 100%; background: #eee; height: 6px; border-radius: 3px; overflow: hidden; }
    .progress-bar { height: 100%; background: linear-gradient(90deg, #9c27b0, var(--primary)); width: 25%; transition: width 0.6s ease; }
    
    .section-indicator{font-size:10px; color:var(--primary); font-weight:700; text-transform:uppercase; margin: 10px 0 5px; display:block;}
    .section-heading{font-size:22px; font-weight:700; color: var(--primary); margin-bottom:10px; border-bottom: 2px solid #f0f0f0; padding-bottom: 3px;}
    
    /* ULTRA COMPACT QUESTION SPACING */
    .question { margin-bottom: 6px; padding: 6px 12px; border-radius: 8px; }
    .question p { font-size: 14px; margin: 0 0 4px 0; font-weight: 600; line-height: 1.2; }
    
    /* Section Specific Styles */
    #section1 .question { background: var(--profile-bg); }
    #section1 .question p { color: var(--profile-text); }

    #section2 .question { background: var(--priority-bg); }
    #section2 .question p { color: var(--priority-text); }
    
    #section3 .question { background: var(--purpose-bg); }
    #section3 .question p { color: var(--purpose-text); }
    
    #section4 .question { background: var(--perf-bg); }
    #section4 .question p { color: var(--perf-text); }

    input, select { width:100%; padding:7px 10px; font-size:13px; border-radius:6px; border:1px solid #d1d9e6; outline: none; box-sizing: border-box; font-family: 'Montserrat', sans-serif; background: rgba(255,255,255,0.8); }
    input:focus, select:focus { border-color: var(--primary); background: #fff; box-shadow: 0 0 5px rgba(103, 58, 183, 0.2); }
    
    .btn-group { margin-top: 15px; display: flex; gap: 10px; }
    button { flex:1; padding:12px; font-size:14px; cursor:pointer; font-weight:700; border-radius:8px; border:none; transition: all 0.2s; text-transform: uppercase; }
    button:hover { filter: brightness(1.1); transform: translateY(-1px); }
    
    .btn-next { background: var(--primary); color: #fff; box-shadow: 0 4px 10px rgba(103, 58, 183, 0.2); }
    .btn-prev { background: #eceff1; color: #546e7a; }
    
    /* Final Results Styling */
    .thank-you-note { text-align: center; margin-bottom: 15px; background: #f1f8e9; padding: 15px; border-radius: 12px; }
    .score-card { background: #fff; border: 1px solid #eef2f7; border-radius: 10px; padding: 10px 18px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.03); }
    .total-box { background: linear-gradient(45deg, var(--primary), #4527a0); color: white; padding: 20px; border-radius: 12px; text-align: center; margin-top: 10px; }
    .error-msg { color: #d32f2f; font-size: 12px; font-weight: 700; margin-top: 5px; text-align: center; }
</style>
</head>
<body>

<div class="form-container">
  <div class="form-header">
    <h1 class="header-title">P3 Assessment</h1>
    <div class="header-subtitle">Priority ‚Ä¢ Purpose ‚Ä¢ Performance</div>
  </div>

  <div class="progress-wrapper">
    <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
  </div>

  <form id="mainForm" class="content-padding" autocomplete="off">
    <div id="section1">
      <span class="section-indicator">Step 1 of 4: Profile</span>
      <h2 class="section-heading">Basic Information</h2>
      <div class="question"><p>Full Name*</p><input id="name" placeholder="Full Name" required></div>
      <div class="question"><p>Age*</p><input id="age" type="number" required></div>
      <div class="question"><p>Profession*</p><input id="profession" required></div>
      <div class="question"><p>Email Address*</p><input id="email" type="email" required></div>
      <div class="question"><p>Mobile Number*</p><input id="mobile" required></div>
      <div class="question"><p>City / Country*</p><input id="city" required></div>
      <div class="question">
        <p>Medical Conditions?*</p>
        <select id="medical" onchange="toggleMedical()" required><option value="">Select Option</option><option>No</option><option>Yes</option></select>
      </div>
      <div id="medical_desc" style="display:none" class="question"><p>Details</p><input id="medical_details"></div>
      <div class="question">
        <p>Worked with health coach earlier?*</p>
        <select id="coach" required><option value="">Select Option</option><option>Yes</option><option>No</option></select>
      </div>
      <button type="button" class="btn-next" style="width:100%; margin-top:10px;" onclick="nextStep(1)">Begin Assessment</button>
    </div>

    <div id="section2" style="display:none">
      <span class="section-indicator">Step 2 of 4: Foundation</span>
      <h2 class="section-heading">Priority</h2>
      <div id="q-container-s2"></div>
      <div class="btn-group">
          <button type="button" class="btn-prev" onclick="prevStep(2)">Back</button>
          <button type="button" class="btn-next" onclick="nextStep(2)">Continue</button>
      </div>
    </div>

    <div id="section3" style="display:none">
      <span class="section-indicator">Step 3 of 4: Mindset</span>
      <h2 class="section-heading">Purpose</h2>
      <div id="q-container-s3"></div>
      <div class="btn-group">
          <button type="button" class="btn-prev" onclick="prevStep(3)">Back</button>
          <button type="button" class="btn-next" onclick="nextStep(3)">Continue</button>
      </div>
    </div>

    <div id="section4" style="display:none">
      <span class="section-indicator">Step 4 of 4: Action</span>
      <h2 class="section-heading">Performance</h2>
      <div id="q-container-s4"></div>
      <div class="btn-group">
          <button type="button" class="btn-prev" onclick="prevStep(4)">Back</button>
          <button type="button" class="btn-next" style="background:var(--secondary);" onclick="submitFinal()">Submit Results</button>
      </div>
    </div>

    <div id="final"></div>
  </form>
</div>

<script>
const q2 = ["I consciously prioritise my health in daily decision-making.", "My daily routine reflects my priorities, not just obligations.", "I allocate time regularly for rest, recovery, or self-care.", "I invest money in health before spending on non-essential comforts.", "My work schedule allows space for health and personal life.", "I can say ‚Äúno‚Äù to activities that harm my long-term wellbeing.", "I am aware of the future cost of ignoring health today.", "Family, work, and personal health are balanced without constant conflict.", "I take responsibility for my lifestyle choices.", "Financial constraints do not completely block my health decisions.", "I plan my day rather than reacting to it.", "I maintain my lifestyle choices even when my social environment does not support them."];
const q3 = ["I clearly understand why staying healthy matters to my life.", "My health goals are connected to a deeper life purpose.", "I understand the basics of nutrition, sleep, and lifestyle health.", "I am aware of my current physical and mental health condition.", "I regularly reflect on where my life is heading.", "My goals are realistic for my age and responsibilities.", "My motivation comes from within, not external pressure.", "I can clearly articulate my long-term life vision.", "I am aware of habits that support or damage my wellbeing.", "I actively seek knowledge related to health and lifestyle.", "I feel mentally aligned with the direction of my life.", "My aspirations are meaningful, not socially driven."];
const q4 = ["I maintain a regular and sufficient sleep routine.", "I engage in physical activity suitable for my age and capacity.", "My food choices are mostly intentional rather than impulsive.", "I remain consistent even when motivation is low.", "I recover adequately after physical or mental exertion.", "I manage stress without unhealthy coping mechanisms.", "I track or review basic health indicators.", "I avoid extreme or unsustainable health practices.", "I adapt my lifestyle when my body signals discomfort.", "I can sustain my routines during busy or stressful periods.", "I feel physically capable of daily activities without fatigue.", "I make healthy decisions even during stressful or emotionally difficult periods."];

const opts = `<option value="">Select Response</option>
              <option value="1">Never / Strongly Disagree</option>
              <option value="2">Rarely / Disagree</option>
              <option value="3">Sometimes / Neutral</option>
              <option value="4">Often / Agree</option>
              <option value="5">Always / Strongly Agree</option>`;

function populate(id, qs, prefix) {
    const c = document.getElementById(id);
    qs.forEach((t, i) => {
        c.innerHTML += `<div class="question"><p>${i + 1}. ${t}</p><select class="${prefix}" required>${opts}</select></div>`;
    });
}

window.onload = () => { 
    populate('q-container-s2', q2, 'Priority'); 
    populate('q-container-s3', q3, 'Purpose'); 
    populate('q-container-s4', q4, 'Performance'); 
};

function toggleMedical(){ document.getElementById("medical_desc").style.display = document.getElementById("medical").value === "Yes" ? "block" : "none"; }
function updateProgress(step) { document.getElementById('progressBar').style.width = (step * 25) + "%"; }

function nextStep(n) { 
    if(!validate('section'+n)){ showErr('section'+n); return; } 
    document.getElementById("section"+n).style.display="none"; 
    document.getElementById("section"+(n+1)).style.display="block"; 
    updateProgress(n + 1);
    window.scrollTo(0,0);
}

function prevStep(n) {
    document.getElementById("section"+n).style.display="none"; 
    document.getElementById("section"+(n-1)).style.display="block"; 
    updateProgress(n - 1);
    window.scrollTo(0,0);
}

function calc(cls){ 
    let s=0; 
    document.querySelectorAll("."+cls).forEach(q=>s+=Number(q.value||0)); 
    return s; 
}

function submitFinal(){
  if(!validate('section4')){ showErr('section4'); return; }
  const s2=calc("Priority"), s3=calc("Purpose"), s4=calc("Performance"), total=s2+s3+s4;
  const userName = document.getElementById("name").value;

  fetch("https://script.google.com/macros/s/AKfycbxzrVxA5YVj-pqEiaxKzax1t37CpHHMIrvFoOuf72Hu7FGNsMb9kiWa4EiNdnHnRJUlaA/exec", {
    method: "POST", mode: "no-cors", headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ fullName: userName, age: document.getElementById("age").value, profession: document.getElementById("profession").value, email: document.getElementById("email").value, mobile: document.getElementById("mobile").value, city: document.getElementById("city").value, coach: document.getElementById("coach").value, section2: s2, section3: s3, section4: s4, totalScore: total })
  });

  document.getElementById("section4").style.display="none";
  document.querySelector(".progress-wrapper").style.display="none";
  
  document.getElementById("final").innerHTML = `
    <div class="thank-you-note">
        <h2>Success!</h2>
        <p>Thank you, <strong>${userName}</strong>. Here is your profile:</p>
    </div>
    <div class="score-card"><span style="color:var(--priority-text); font-weight:700;">üéØ Priority</span><span>${s2}/60</span></div>
    <div class="score-card"><span style="color:var(--purpose-text); font-weight:700;">üß† Purpose</span><span>${s3}/60</span></div>
    <div class="score-card"><span style="color:var(--perf-text); font-weight:700;">‚ö° Performance</span><span>${s4}/60</span></div>
    <div class="total-box">
      <div style="font-size:12px; opacity:0.8;">P3 INDEX</div>
      <div style="font-size:48px; font-weight:800;">${total} <small style="font-size:16px;">/ 180</small></div>
    </div>
    <button type="button" class="btn-next" style="margin-top:15px; width:100%;" onclick="window.print()">Download PDF</button>
  `;
  window.scrollTo(0,0);
}

function validate(id){
  let v = true;
  document.getElementById(id).querySelectorAll("input, select").forEach(el => { 
      if(el.id === "medical_details" || el.offsetParent === null) return;
      if(el.hasAttribute('required') && !el.value) v = false; 
  });
  return v;
}

function showErr(id){
  const s = document.getElementById(id);
  if(!s.querySelector(".error-msg")){
    const d = document.createElement("div"); d.className="error-msg"; 
    d.innerText="‚ö†Ô∏è Please answer all questions."; 
    s.appendChild(d);
    setTimeout(() => d.remove(), 3000);
  }
}
</script>
</body>
</html>
