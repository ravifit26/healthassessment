<!DOCTYPE html>
<html>
<head>
<title>Health & Lifestyle Assessment</title>
<style>
    body{font-family:Roboto,Arial,sans-serif;background:#f1f3f4;margin:0;padding:30px 0;}
    .form-container{background:#ffffff;max-width:820px;margin:0 auto;border-radius:8px;box-shadow:0 1px 6px rgba(0,0,0,.15);padding:30px 40px 40px;}
    .form-header{background:#673ab7;padding:36px 20px;border-radius:8px 8px 0 0;text-align:center;}
    .header-title{color:#ffffff;font-size:28px;font-weight:600;line-height:1.4;}
    
    /* Progress Bar Styles */
    .progress-container { width: 100%; background: #e0e0e0; height: 8px; border-radius: 4px; margin: 20px 0; overflow: hidden; }
    .progress-bar { height: 100%; background: #673ab7; width: 25%; transition: width 0.4s ease; }
    
    .section-indicator{font-size:13px;color:#673ab7;font-weight:500;margin-bottom:8px}
    .section-heading{font-size:22px;font-weight:600;color:#673ab7;margin:30px 0 20px;}
    .question{margin-bottom:22px;}
    .question p{font-size:15px;margin-bottom:6px}
    input,select{width:100%;max-width:650px;padding:10px;font-size:14px;border-radius:4px;border:1px solid #dadce0;box-sizing:border-box;}
    
    .btn-group { margin-top: 20px; display: flex; gap: 10px; }
    button{background:#673ab7;color:#fff;border:none;border-radius:4px;padding:12px 28px;font-size:14px;cursor:pointer;font-weight:500;}
    button.secondary{background:#9e9e9e;}
    button:hover{opacity: 0.9;}
    
    .score-box{background:#f8f9fa;border-left:8px solid #673ab7;padding:25px;border-radius:4px;margin:25px 0;}
    .result-row{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid #eee;}
    .error-msg{color:red;font-size:13px;margin-top:8px;}
    .required-star{color:red;font-weight:bold;margin-left:4px;}
    .benchmark-container{background:#e8eaf6; padding:20px; border-radius:8px; margin-top:20px; font-size:14px; line-height:1.6;}
</style>
</head>
<body>

<form class="form-container" id="mainForm">
  <div class="form-header">
    <div class="header-title">P3 Framework: Priority • Purpose • Performance</div>
  </div>

  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div id="section1">
    <div class="section-indicator">Section 1 of 4: Personal Details</div>
    <div class="question"><p>Full Name<span class='required-star'>*</span></p><input id="name" required></div>
    <div class="question"><p>Age<span class='required-star'>*</span></p><input id="age" type="number" required></div>
    <div class="question"><p>Gender (Optional)</p><select id="gender"><option value="">Select</option><option>Male</option><option>Female</option><option>Other</option></select></div>
    <div class="question"><p>City / Country<span class='required-star'>*</span></p><input id="city" required></div>
    <div class="question"><p>Profession<span class='required-star'>*</span></p><input id="profession" required></div>
    <div class="question"><p>Email<span class='required-star'>*</span></p><input id="email" type="email" required></div>
    <div class="question"><p>Mobile<span class='required-star'>*</span></p><input id="mobile" required></div>
    <div class="question">
      <p>Medical Conditions?<span class='required-star'>*</span></p>
      <select id="medical" onchange="toggleMedical()" required><option value="">Select</option><option>No</option><option>Yes</option></select>
    </div>
    <div class="question" id="medical_desc" style="display:none"><p>Details</p><input id="medical_details"></div>
    <div class="question">
      <p>Worked with coach before?<span class='required-star'>*</span></p>
      <select id="coach" required><option value="">Select</option><option>Yes</option><option>No</option></select>
    </div>
    <button type="button" onclick="nextStep(1)">Proceed to Assessment</button>
  </div>

  <div id="section2" style="display:none">
    <div class="section-indicator">Section 2 of 4</div>
    <div class="section-heading">Priority</div>
    <div id="q-container-s2"></div>
    <div class="btn-group">
        <button type="button" class="secondary" onclick="prevStep(2)">Previous</button>
        <button type="button" onclick="nextStep(2)">Continue</button>
    </div>
  </div>

  <div id="section3" style="display:none">
    <div class="section-indicator">Section 3 of 4</div>
    <div class="section-heading">Purpose</div>
    <div id="q-container-s3"></div>
    <div class="btn-group">
        <button type="button" class="secondary" onclick="prevStep(3)">Previous</button>
        <button type="button" onclick="nextStep(3)">Continue</button>
    </div>
  </div>

  <div id="section4" style="display:none">
    <div class="section-indicator">Section 4 of 4</div>
    <div class="section-heading">Performance</div>
    <div id="q-container-s4"></div>
    <div class="btn-group">
        <button type="button" class="secondary" onclick="prevStep(4)">Previous</button>
        <button type="button" onclick="submitFinal()">Submit Assessment</button>
    </div>
  </div>

  <div id="final"></div>
</form>

<script>
// Question Data
const q2 = ["I consciously prioritise my health in daily decision-making.", "My daily routine reflects my priorities, not just obligations.", "I allocate time regularly for rest, recovery, or self-care.", "I invest money in health before spending on non-essential comforts.", "My work schedule allows space for health and personal life.", "I can say “no” to activities that harm my long-term wellbeing.", "I am aware of the future cost of ignoring health today.", "Family, work, and personal health are balanced without constant conflict.", "I take responsibility for my lifestyle choices.", "Financial constraints do not completely block my health decisions.", "I plan my day rather than reacting to it.", "I maintain my lifestyle choices even when my social environment does not support them."];
const q3 = ["I clearly understand why staying healthy matters to my life.", "My health goals are connected to a deeper life purpose.", "I understand the basics of nutrition, sleep, and lifestyle health.", "I am aware of my current physical and mental health condition.", "I regularly reflect on where my life is heading.", "My goals are realistic for my age and responsibilities.", "My motivation comes from within, not external pressure.", "I can clearly articulate my long-term life vision.", "I am aware of habits that support or damage my wellbeing.", "I actively seek knowledge related to health and lifestyle.", "I feel mentally aligned with the direction of my life.", "My aspirations are meaningful, not socially driven."];
const q4 = ["I maintain a regular and sufficient sleep routine.", "I engage in physical activity suitable for my age and capacity.", "My food choices are mostly intentional rather than impulsive.", "I remain consistent even when motivation is low.", "I recover adequately after physical or mental exertion.", "I manage stress without unhealthy coping mechanisms.", "I track or review basic health indicators.", "I avoid extreme or unsustainable health practices.", "I adapt my lifestyle when my body signals discomfort.", "I can sustain my routines during busy or stressful periods.", "I feel physically capable of daily activities without fatigue.", "I make healthy decisions even during stressful or emotionally difficult periods."];

const opts = `<option value="">Select</option><option value="1">Never / Strongly Disagree</option><option value="2">Rarely / Disagree</option><option value="3">Sometimes / Neutral</option><option value="4">Often / Agree</option><option value="5">Always / Strongly Agree</option>`;

function populate(id, qs, prefix) {
    const c = document.getElementById(id);
    qs.forEach((t, i) => {
        c.innerHTML += `<div class="question"><p>${i + 1}. ${t}</p><select class="${prefix}" required>${opts}</select></div>`;
    });
}

window.onload = () => { 
    populate('q-container-s2', q2, 'Priority'); 
    populate('q-container-s3', q3, 'Purpose'); 
    populate('q-container-s4', q4, 'Performance'); 
};

function toggleMedical(){ 
    document.getElementById("medical_desc").style.display = document.getElementById("medical").value === "Yes" ? "block" : "none"; 
}

function updateProgress(step) {
    const bar = document.getElementById('progressBar');
    bar.style.width = (step * 25) + "%";
}

function nextStep(n) { 
    if(!validate('section'+n)){ 
        showErr('section'+n); 
        return; 
    } 
    document.getElementById("section"+n).style.display="none"; 
    document.getElementById("section"+(n+1)).style.display="block"; 
    updateProgress(n + 1);
    window.scrollTo(0,0);
}

function prevStep(n) {
    document.getElementById("section"+n).style.display="none"; 
    document.getElementById("section"+(n-1)).style.display="block"; 
    updateProgress(n - 1);
    window.scrollTo(0,0);
}

function calc(cls){ 
    let s=0; 
    document.querySelectorAll("."+cls).forEach(q=>s+=Number(q.value||0)); 
    return s; 
}

function submitFinal(){
  if(!validate('section4')){ showErr('section4'); return; }
  updateProgress(4);
  const s2=calc("Priority"), s3=calc("Purpose"), s4=calc("Performance"), total=s2+s3+s4;
  const userName = document.getElementById("name").value;

  fetch("https://script.google.com/macros/s/AKfycbxzrVxA5YVj-pqEiaxKzax1t37CpHHMIrvFoOuf72Hu7FGNsMb9kiWa4EiNdnHnRJUlaA/exec", {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      fullName: userName,
      age: document.getElementById("age").value,
      gender: document.getElementById("gender").value,
      city: document.getElementById("city").value,
      profession: document.getElementById("profession").value,
      email: document.getElementById("email").value,
      mobile: document.getElementById("mobile").value,
      section2: s2,
      section3: s3,
      section4: s4,
      totalScore: total
    })
  });

  document.getElementById("section4").style.display="none";
  document.querySelector(".progress-container").style.display="none";
  document.getElementById("final").innerHTML = `
    <div class="score-box">
      <h2>Thank You, ${userName}!</h2>
      <p>Your assessment results:</p>
      <div class="result-row"><span>Priority Score:</span> <span>${s2} / 60</span></div>
      <div class="result-row"><span>Purpose Score:</span> <span>${s3} / 60</span></div>
      <div class="result-row"><span>Performance Score:</span> <span>${s4} / 60</span></div>
      <div style="background:#673ab7; color:white; padding:15px; border-radius:8px; text-align:center; margin-top:15px;">
        <h3 style="margin:0;">Grand Total: ${total} / 180</h3>
      </div>
      <div class="benchmark-container">
        <strong>Overall (36-180):</strong><br>
        • 150-180: Stable & Aligned<br>
        • 105-149: Moderate (Needs Refinement)<br>
        • 36-104: Needs Guidance
      </div>
    </div>`;
    window.scrollTo(0,0);
}

function validate(id){
  let v = true;
  document.getElementById(id).querySelectorAll("input, select").forEach(el => { 
      if(el.id === "gender" || el.id === "medical_details" || el.offsetParent === null) return;
      if(el.hasAttribute('required') && !el.value) v = false; 
  });
  return v;
}

function showErr(id){
  let s = document.getElementById(id);
  if(!s.querySelector(".error-msg")){
    let d = document.createElement("div"); 
    d.className="error-msg"; 
    d.innerText="Please fill all required fields before proceeding."; 
    s.appendChild(d);
    setTimeout(() => d.remove(), 3000);
  }
}
</script>
</body>
</html>
